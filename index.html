<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Cinema </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #0f2134; 
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; 
        }

        #app-container {
            z-index: 10;
            position: relative;
        }
        
        #loader {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 27, 42, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out;
        }

        @keyframes pulseGlow {
            0%, 100% { text-shadow: 0 0 5px #00FFFF, 0 0 10px #00FFFF; }
            50% { text-shadow: 0 0 15px #3B82F6, 0 0 25px #3B82F6; }
        }

        .loading-text {
            animation: pulseGlow 1.5s infinite alternate;
        }
        .hologram-card {
            background: rgba(30, 41, 59, 0.7); 
            backdrop-filter: blur(5px);
            border: 2px solid;
            border-image: linear-gradient(to right, #00FFFF, #3B82F6, #00FFFF) 1;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5), 0 0 40px rgba(0, 255, 255, 0.2);
            transform: scale(0.8) translateY(50px);
            opacity: 0;
            transition: all 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
        }

        .hologram-card.is-active {
            transform: scale(1) translateY(0);
            opacity: 1;
        }
        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            pointer-events: none;
            animation: twinkle linear infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 0.3; transform: scale(0.5); }
        }

        .cosmic-button {
            transition: all 0.3s ease;
            box-shadow: 0 0 5px rgba(59, 130, 246, 0.5);
        }
        .cosmic-button:hover {
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.8), 0 0 30px rgba(0, 255, 255, 0.4);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>

    <!-- Star Field Container (Generated by JavaScript) -->
    <div id="star-field" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%;"></div>

    <!-- Main Application Container -->
    <div id="app-container" class="w-full max-w-4xl p-4 md:p-8">

        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-2 tracking-widest">
                Mood Cinema
            </h1>
            <p class="text-xl text-indigo-300 font-light">
                Pull your next cinematic journey from the void.
            </p>
        </header>

        <!-- Control Panel -->
        <div class="flex flex-col md:flex-row gap-4 mb-12 bg-gray-800/70 p-6 rounded-xl shadow-2xl items-end">
            <div class="flex-grow w-full">
                <label for="genre-select" class="block text-sm font-medium text-indigo-300 mb-2">
                    Select Your Cosmic Trajectory:
                </label>
                <select id="genre-select" class="w-full p-3 rounded-lg bg-gray-900 border border-indigo-500 text-white focus:ring-indigo-400 focus:border-indigo-400">
                    <option value="All">Any Genre (Default)</option>
                    <option value="Sci-Fi">Sci-Fi / Fantasy</option>
                    <option value="Action">Action / Thriller</option>
                    <option value="Drama">Drama / Historical</option>
                    <option value="Comedy">Comedy / Family</option>
                </select>
            </div>
            <button onclick="suggestMovie()" class="cosmic-button w-full md:w-auto px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl uppercase tracking-wider text-lg shadow-lg">
                Search
            </button>
        </div>

        <!-- Result Display (Holographic Card) -->
        <div id="result-card" class="hologram-card p-6 md:p-8 rounded-2xl w-full mx-auto" style="display: none;">
            
            <h2 id="movie-title" class="text-3xl md:text-4xl font-extrabold text-cyan-300 mb-3 leading-tight"></h2>
            
            <div class="flex flex-wrap gap-x-4 gap-y-2 mb-4 text-sm text-indigo-200">
                <span id="movie-year" class="font-semibold px-3 py-1 bg-gray-700 rounded-full"></span>
                <span id="movie-genre" class="font-semibold px-3 py-1 bg-gray-700 rounded-full uppercase"></span>
            </div>

            <p id="movie-description" class="text-gray-300 text-base mb-6 border-l-4 border-cyan-500 pl-4 italic"></p>
            
            <div class="text-right">
                <span class="text-indigo-400 font-medium">Source: Star Catalog L16</span>
            </div>
        </div>

    </div>
    
    <!-- Loading Overlay -->
    <div id="loader">
        <div class="text-4xl font-bold text-cyan-300 loading-text">
            Scanning the Nebula...
        </div>
    </div>

    <script>
        // --- Mock Movie Data ---
        const movies = [
            { title: "Inception", genre: "Sci-Fi", year: 2010, description: "A thief who steals corporate secrets through the use of dream-sharing technology is given the inverse task of planting an idea into the mind of a C.E.O." },
            { title: "Mad Max: Fury Road", genre: "Action", year: 2015, description: "In a post-apocalyptic wasteland, a woman rebels against a tyrannical ruler in search of her homeland with the aid of a group of female prisoners and a drifter named Max." },
            { title: "Dune", genre: "Sci-Fi", year: 2021, description: "A noble family becomes embroiled in a war for control over the galaxy's most valuable asset, the spice, on a desert planet known as Arrakis." },
            { title: "Pulp Fiction", genre: "Drama", year: 1994, description: "The lives of two mob hitmen, a boxer, a gangster and his wife, and a pair of diner bandits intertwine in four tales of violence and redemption." },
            { title: "Spirited Away", genre: "Fantasy", year: 2001, description: "During her family's move to the suburbs, a sullen 10-year-old girl wanders into a world ruled by gods, witches, and spirits, and where humans are changed into beasts." },
            { title: "Hidden Figures", genre: "Drama", year: 2016, description: "The story of a team of female African-American mathematicians who served a vital role in NASA during the early years of the U.S. space program." },
            { title: "Knives Out", genre: "Comedy", year: 2019, description: "A detective investigates the death of a patriarch of an eccentric, combative family." },
            { title: "Everything Everywhere All at Once", genre: "Action", year: 2022, description: "An aging Chinese immigrant is swept up in an insane adventure, where she alone can save the world by exploring other universes connecting with the lives she could have led." },
        ];

        const loader = document.getElementById('loader');
        const resultCard = document.getElementById('result-card');
        const genreSelect = document.getElementById('genre-select');
        let isProcessing = false;

       
        function base64ToArrayBuffer(base64) {
            const binaryString = atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }

        async function runWithBackoff(operation, retries = 3, delay = 1000) {
            for (let i = 0; i < retries; i++) {
                try {
                    return await operation();
                } catch (error) {
                    if (i === retries - 1) {
                        throw error;
                    }
                    await new Promise(resolve => setTimeout(resolve, delay * (2 ** i)));
                }
            }
        }

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min)) + min;
        }
        async function suggestMovie() {
            if (isProcessing) return;
            isProcessing = true;
         
            const selectedGenre = genreSelect.value;
            
           
            const filteredMovies = selectedGenre === 'All' 
                ? movies 
                : movies.filter(m => m.genre.includes(selectedGenre) || m.genre === selectedGenre);

            if (filteredMovies.length === 0) {
                alertUser("No results found for that cosmic trajectory.", "Please select a different genre.");
                isProcessing = false;
                return;
            }

          
            resultCard.classList.remove('is-active');
            loader.style.opacity = '1';
            loader.style.pointerEvents = 'auto';
            resultCard.style.display = 'none';

            try {
                // Simulate network latency using the backoff structure
                await runWithBackoff(() => new Promise(resolve => setTimeout(resolve, getRandomInt(1500, 2500))));

                // 4. Select a random movie from the filtered list
                const randomIndex = getRandomInt(0, filteredMovies.length);
                const suggested = filteredMovies[randomIndex];

                // 5. Populate the Hologram Card
                document.getElementById('movie-title').textContent = suggested.title;
                document.getElementById('movie-year').textContent = suggested.year;
                document.getElementById('movie-genre').textContent = suggested.genre;
                document.getElementById('movie-description').textContent = suggested.description;

                // 6. Hide loading and show the result card with animation
                loader.style.opacity = '0';
                loader.style.pointerEvents = 'none';

                // Give a slight delay before revealing the card for smooth transition
                setTimeout(() => {
                    resultCard.style.display = 'block';
                    // Trigger the CSS transition
                    resultCard.classList.add('is-active');
                }, 100); 

            } catch (error) {
                console.error("Cosmic Projector error:", error);
                alertUser("Transmission Error", "Could not connect to the Star Catalog. Please try again.");
                loader.style.opacity = '0';
                loader.style.pointerEvents = 'none';
            } finally {
                isProcessing = false;
            }
        }

        /**
         * Custom message box instead of alert().
         */
        function alertUser(title, message) {
            const overlay = document.createElement('div');
            overlay.className = "fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50";
            overlay.innerHTML = `
                <div class="bg-gray-900 p-8 rounded-xl shadow-2xl border-2 border-red-500 max-w-sm w-full text-center transform scale-0 transition-all duration-300" id="alert-box">
                    <h3 class="text-2xl font-bold text-red-400 mb-3">${title}</h3>
                    <p class="text-gray-300 mb-6">${message}</p>
                    <button class="px-6 py-2 bg-red-600 hover:bg-red-500 text-white font-semibold rounded-lg" onclick="document.body.removeChild(this.closest('.fixed'))">
                        Acknowledge
                    </button>
                </div>
            `;
            document.body.appendChild(overlay);
            // Animate the alert box in
            setTimeout(() => {
                document.getElementById('alert-box').classList.remove('scale-0');
            }, 10);
        }

        // --- Star Field Generation ---
        function generateStarField(count = 150) {
            const container = document.getElementById('star-field');
            const w = window.innerWidth;
            const h = window.innerHeight;

            for (let i = 0; i < count; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                const size = Math.random() * 3 + 0.5; // Size between 0.5px and 3.5px
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.top = `${Math.random() * h}px`;
                star.style.left = `${Math.random() * w}px`;
                star.style.animationDuration = `${Math.random() * 3 + 1}s`; // 1s to 4s
                star.style.animationDelay = `${Math.random() * 5}s`;
                container.appendChild(star);
            }
        }

        // Initialize star field on load
        window.onload = generateStarField;

    </script>
</body>
</html>
